(()=>{var e={};e.id=5030,e.ids=[5030],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},71017:e=>{"use strict";e.exports=require("path")},57310:e=>{"use strict";e.exports=require("url")},9613:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>d,routeModule:()=>h,tree:()=>l});var r=s(67096),a=s(16132),i=s(37284),n=s.n(i),o=s(32564),c={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);s.d(t,c);let l=["",{children:["purchases",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,58857)),"/Users/saideekshithkatukojwala/Documents/Code/Projects/box-office/client/src/app/purchases/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,79113)),"/Users/saideekshithkatukojwala/Documents/Code/Projects/box-office/client/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],d=["/Users/saideekshithkatukojwala/Documents/Code/Projects/box-office/client/src/app/purchases/page.tsx"],u="/purchases/page",x={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/purchases/page",pathname:"/purchases",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},80932:(e,t,s)=>{Promise.resolve().then(s.bind(s,44762))},44762:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var r=s(30784),a=s(9885),i=s(62450),n=s(23458);s(48451);var o=s(21971),c=s.n(o),l=s(76267),d=s.n(l),u=s(23282),x=s.n(u),h=s(1853),p=s.n(h),m=s(33987),_=s.n(m),j=s(16614),f=s.n(j),g=s(43872),v=s(92133),y=s.n(v),k=s(62969),P=s.n(k),b=s(42153),w=s.n(b),C=s(16856),q=s.n(C),E=s(95915),T=s.n(E),S=s(19659),A=s(15050),D=s(57114);let TicketCard=({ticket:e,refresh:t})=>{let s=e.qr_url;(0,D.useRouter)();let[i,n]=(0,a.useState)(!1),handleCloseModal=()=>{t(),n(!1)},handleYes=async()=>{await (0,A.e)(e,"user/cancelTicket","POST"),n(!1),t()};return(0,r.jsxs)(d(),{sx:{m:2,boxShadow:3,width:"500px",height:"400px",padding:"0px 0px"},children:[r.jsx(x(),{component:"img",height:"140",image:e.movie.poster_url,alt:`${e.movie.name} Poster`}),(0,r.jsxs)(c(),{container:!0,spacing:2,children:[r.jsx(c(),{item:!0,xs:8,children:(0,r.jsxs)(p(),{children:[r.jsx(_(),{gutterBottom:!0,variant:"h5",component:"div",children:e.movie.name}),r.jsx(_(),{variant:"body2",color:"text.secondary",children:e.theater}),(0,r.jsxs)(_(),{variant:"body2",color:"text.secondary",children:[new Date(e.details.show_date).toLocaleDateString()," â€¢ ",e.details.show_time]}),(0,r.jsxs)(_(),{variant:"body2",color:"text.secondary",children:["Screen: ",e.details.screen_id]}),(0,r.jsxs)(_(),{variant:"body2",color:"text.secondary",children:["Seats: ",e.details.seat_ids?e.details.seat_ids.join(", "):"No seats available"]}),(0,r.jsxs)(_(),{variant:"body2",color:"text.secondary",children:["Price: $",e.details.price]})]})}),(0,r.jsxs)(c(),{item:!0,xs:4,children:[(0,r.jsxs)(S.Stack,{direction:"column",spacing:2,children:[e.details.refund_requested?"":r.jsx("img",{src:s,alt:"QR Code",style:{maxWidth:"100%",maxHeight:"100%",height:"auto"}}),e.details.refund_requested?"":r.jsx(f(),{sx:{color:"red"},onClick:()=>{n(!0)},children:"Cancel"})]}),r.jsx(g.default,{mt:5,children:r.jsx(_(),{variant:"subtitle1",children:e.details.refund_requested?r.jsx(y(),{label:"Cancelled",color:"error"}):""})})]}),(0,r.jsxs)(P(),{open:i,onClose:handleCloseModal,children:[r.jsx(w(),{children:"Confirmation"}),r.jsx(q(),{children:"Are you sure you want to cancel?"}),(0,r.jsxs)(T(),{children:[r.jsx(f(),{onClick:handleCloseModal,color:"primary",children:"No"}),r.jsx(f(),{onClick:handleYes,sx:{color:"red"},children:"Yes"})]})]})]})]})},__WEBPACK_DEFAULT_EXPORT__=()=>{let[e,t]=(0,a.useState)([]),[s,o]=(0,a.useState)(!0),[l,d]=(0,a.useState)(null),[u,x]=(0,a.useState)(!1),h=(0,n.Z)(),fetchTickets=async()=>{try{let e=await (0,A.e)("",`user/getPurchaseHistory/${h.user?.user_id}`,"GET");if(!e||!Array.isArray(e.data))throw Error("Data is not in the expected format");t(e.data),o(!1)}catch(e){console.error("Fetching tickets failed: ",e),d(e.message),o(!1)}};if((0,a.useEffect)(()=>{h.user?.user_id?fetchTickets():(d("User ID is not available."),o(!1))},[]),s)return r.jsx("div",{children:"Loading..."});if(l)return(0,r.jsxs)("div",{children:["Error: ",l]});function refresh(){fetchTickets()}return r.jsx(c(),{item:!0,xs:4,sx:{paddingLeft:"90px"},children:r.jsx(i.Z,{title:"Purchases",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-6",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Your Tickets"}),r.jsx("div",{className:"ticket-grid",children:e.map((e,t)=>r.jsx(TicketCard,{ticket:e,refresh:refresh},t))})]})})})}},58857:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>i,default:()=>c});var r=s(95153);let a=(0,r.createProxy)(String.raw`/Users/saideekshithkatukojwala/Documents/Code/Projects/box-office/client/src/app/purchases/page.tsx`),{__esModule:i,$$typeof:n}=a,o=a.default,c=o},48451:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[2958,1323,6267,1853,938,3282,2153,9867,884],()=>__webpack_exec__(9613));module.exports=s})();