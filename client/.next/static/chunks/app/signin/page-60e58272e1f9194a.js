(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4281],{42494:function(e,r,s){Promise.resolve().then(s.bind(s,48874))},48874:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return SignIn}});var n=s(57437),i=s(2265),t=s(24033),o=s(3283),a=s(49050),d=s(3857),l=s(55594),c=s(25210),u=s(28874),m=s(39227),g=s(16531),h=s(43226),p=s(63955),f=s(24256),x=s(56413),w=s(5925),y=s(38110),j=s(80528),P=s(61865),Z=s(16896);function Copyright(e){return(0,n.jsxs)(h.Z,{variant:"body2",color:"text.secondary",align:"center",...e,children:["Copyright \xa9 ",(0,n.jsx)(c.Z,{color:"inherit",href:"https://mui.com/",children:"Box Office"})," ",new Date().getFullYear(),"."]})}function SignIn(){let[e,r]=i.useState(!1),s=(0,Z.Z)(),{register:E,handleSubmit:b,formState:{errors:q}}=(0,P.cI)({resolver:(0,y.F)(j.V)}),I=(0,t.useRouter)(),getErrorMessage=e=>e&&"string"==typeof e.message?e.message:"";async function signInUser(e){r(!0);try{let r=await (0,f.NI)(JSON.stringify(e));s.setLoggedIn(),s.setUser(r),s.setIsAdmin(r.isAdmin),I.push("/")}catch(e){e instanceof Error?(0,x.zG)(e):(w.ZP.error(e.message),console.log("Error message:",e.message))}finally{r(!1)}}return(0,n.jsxs)(p.Z,{component:"main",maxWidth:"xs",children:[(0,n.jsx)(d.ZP,{}),(0,n.jsxs)(m.Z,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,n.jsx)(o.Z,{sx:{m:1,bgcolor:"secondary.main"},children:(0,n.jsx)(g.Z,{})}),(0,n.jsx)(h.Z,{component:"h1",variant:"h5",children:"Sign in"}),(0,n.jsxs)(m.Z,{component:"form",noValidate:!0,onSubmit:b(e=>{signInUser(e)}),sx:{mt:3},children:[(0,n.jsxs)(u.ZP,{container:!0,spacing:2,children:[(0,n.jsx)(u.ZP,{item:!0,xs:12,children:(0,n.jsx)(l.Z,{...E("email"),fullWidth:!0,id:"email",label:"Email Address",autoComplete:"email",error:!!q.email,helperText:getErrorMessage(q.email)})}),(0,n.jsx)(u.ZP,{item:!0,xs:12,children:(0,n.jsx)(l.Z,{...E("password"),fullWidth:!0,type:"password",id:"password",label:"Password",autoComplete:"new-password",error:!!q.password,helperText:getErrorMessage(q.password)})})]}),(0,n.jsx)(a.Z,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},children:e?(0,n.jsx)("span",{children:"Loading..."}):(0,n.jsx)("span",{children:" Sign In"})}),(0,n.jsx)(u.ZP,{container:!0,children:(0,n.jsx)(u.ZP,{item:!0,children:(0,n.jsx)(c.Z,{href:"/signup",variant:"body2",children:"Don't have an account? Sign Up"})})})]})]}),(0,n.jsx)(Copyright,{sx:{mt:8,mb:4}})]})}},24256:function(e,r,s){"use strict";s.d(r,{NI:function(){return apiLoginUser},y4:function(){return apiRegisterUser}});let n="http://ec2-3-101-12-15.us-west-1.compute.amazonaws.com/api";async function handleResponse(e){let r=e.headers.get("Content-Type")||"",s=r.includes("application/json"),n=s?await e.json():await e.text();if(!e.ok){if(s&&null!==n.errors)throw Error(JSON.stringify(n.errors));throw Error(n.message||e.statusText)}return n}async function apiRegisterUser(e){let r=await fetch("".concat(n,"/user/signup"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:e});return handleResponse(r).then(e=>e.message)}async function apiLoginUser(e){let r=await fetch("".concat(n,"/user/login"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:e});return console.log(r),handleResponse(r).then(e=>e.data)}},56413:function(e,r,s){"use strict";s.d(r,{zG:function(){return handleApiError}}),s(79874);var n=s(5925);function handleApiError(e){try{let r;try{r=JSON.parse(e.message)}catch(r){n.ZP.error(e.message);return}if("object"==typeof r&&null!==r&&"fieldErrors"in r){let e=r.fieldErrors;Object.keys(e).forEach(r=>{let s=e[r];if(s.length>0){let e=s[0];n.ZP.error(e)}})}}catch(e){n.ZP.error(e)}}s(62601)},80528:function(e,r,s){"use strict";s.d(r,{V:function(){return t},_:function(){return i}});var n=s(74578);let i=n.z.object({name:n.z.string({required_error:"Name is required"}).min(1,"Full name is required"),email:n.z.string({required_error:"Email is required"}).min(1,"Email is required").email("Email is invalid"),password:n.z.string({required_error:"Password is required"}).min(1,"Password is required").min(8,"Password must be more than 8 characters").max(32,"Password must be less than 32 characters"),confirmPassword:n.z.string({required_error:"Confirm your password"}).min(1,"Confirm your password")}).refine(e=>e.password===e.confirmPassword,{path:["confirmPassword"],message:"Passwords do not match"}),t=n.z.object({email:n.z.string({required_error:"Email is required"}).min(1,"Email is required").email("Email is invalid"),password:n.z.string({required_error:"Password is required"}).min(1,"Password is required").min(8,"Password must be at least 8 characters")})},16896:function(e,r,s){"use strict";var n=s(94660),i=s(74810);let t=(0,n.Ue)((0,i.tJ)(e=>({authUser:null,isLoggedIn:!1,requestLoading:!1,user:null,pincode:null,isAdmin:!1,setIsAdmin:r=>e(e=>({...e,isAdmin:r})),setUser:r=>e(e=>({...e,user:r})),setLoggedIn:()=>e(e=>({...e,isLoggedIn:!0})),setLoggedOut:()=>e(e=>({...e,isLoggedIn:!1})),setAuthUser:r=>e(e=>({...e,authUser:r})),setPinCode:r=>e(e=>({...e,pincode:r})),setRequestLoading:r=>e(e=>({...e,requestLoading:r})),reset:()=>e({authUser:null,requestLoading:!1})}),{name:"user-storage"}));r.Z=t}},function(e){e.O(0,[5094,3226,4876,5295,8874,1444,2171,8500,5594,644,5166,329,2554,2971,2472,1744],function(){return e(e.s=42494)}),_N_E=e.O()}]);