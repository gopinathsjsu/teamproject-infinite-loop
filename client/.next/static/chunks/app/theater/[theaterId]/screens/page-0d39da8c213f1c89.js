(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9504],{11865:function(e,t,n){Promise.resolve().then(n.bind(n,23734))},23734:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Screen}});var r=n(57437),i=n(2265),s=n(24033),a=n(63955),o=n(3857),c=n(28874),l=n(43226),d=n(49050),m=n(39227),x=n(26931),u=n(39350),h=n(72261),p=n(98075),f=n(84081),g=n(50819),b=n(10654),j=n(65507),Z=n(45550),y=n(55594),S=n(13391),v=n(634),w=n(26398),P=n(36661),_=n(61865),k=n(38110),M=n(74578);let C={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4},R=M.Ry({movie:M.Z_().min(1,"Movie is required"),ticketPrice:M.Z_().min(1,"ticket price is required")});function Screen(){let e=(0,s.useRouter)(),{theaterId:t}=(0,s.useParams)(),n=(0,s.useSearchParams)(),[M,E]=(0,i.useState)([]),[T,I]=i.useState(!1),[z,D]=(0,i.useState)([]),[O,W]=(0,i.useState)(null),{handleSubmit:A,control:F,formState:{errors:N}}=(0,_.cI)({resolver:(0,k.F)(R)});(0,i.useEffect)(()=>{let fetchScreenData=async()=>{console.log(t);let e=String(t),n=await (0,P.e)("","screen/"+e,"GET"),r=n.data;console.log(r);let i=r.map(e=>({id:e.id,name:e.name,timings:e.show_timings,maxCapacity:e.seating_capacity,imageUrl:e.movie_image,format:e.format,currentMovie:e.movie_name,runtime:e.run_time,cost:e.cost}));E(i)},fetchMovieData=async()=>{let e=await (0,P.e)("","movie/all","GET"),t=e.movies,n=t.map(e=>({id:e.id,name:e.title}));console.log(n),D(n)};fetchScreenData(),fetchMovieData()},[]);let getErrorMessage=e=>e&&"string"==typeof e.message?e.message:"",G=(0,i.useCallback)(e=>{let t=e.map(e=>Object.entries(e)),r=new URLSearchParams(n);return t.forEach(e=>{r.set(e[0],e[1])}),r.toString()},[n]);async function onSubmit(e){e.theater_id=t,e.screen_id=O;try{await (0,P.e)(e,"screen/addMovie","POST");let n=await (0,P.e)("","screen/"+t,"GET"),r=n.data,i=r.map(e=>({id:e.id,name:e.screen_name,timings:e.show_timings,maxCapacity:e.seating_capacity,imageUrl:e.movie_image,format:e.screen_type,currentMovie:e.movie_name,runtime:String(e.run_time),cost:e.cost}));E(i)}catch(e){console.log(e)}}let handleOpenModal=e=>{console.log(e),W(e),I(!T)};return(0,r.jsxs)(i.Fragment,{children:[(0,r.jsx)(o.ZP,{}),(0,r.jsx)(a.Z,{maxWidth:"xl",children:(0,r.jsxs)(c.ZP,{container:!0,spacing:2,children:[(0,r.jsxs)(c.ZP,{container:!0,sx:{mb:2,marginTop:10,justifyContent:"space-between"},children:[(0,r.jsx)(l.Z,{variant:"h4",children:"Screens"}),(0,r.jsx)(d.Z,{variant:"contained",startIcon:(0,r.jsx)(v.Z,{}),onClick:()=>{e.push("/theater/"+t+"/addScreen")},children:"Add Screen"})]}),(0,r.jsx)(c.ZP,{item:!0,xs:12,container:!0,children:(0,r.jsx)(c.ZP,{container:!0,spacing:2,alignItems:"center",justifyContent:"left",children:M.map((e,n)=>(0,r.jsx)(c.ZP,{item:!0,xs:12,md:6,lg:6,children:(0,r.jsxs)(m.Z,{sx:{bgcolor:"white",p:3,borderRadius:2,boxShadow:3,display:"flex",flexDirection:{xs:"column",md:"row"},alignItems:"center"},children:[(0,r.jsx)("img",{src:e.imageUrl,alt:"screeb",style:{marginBottom:16,marginRight:24,width:192,borderRadius:8}}),(0,r.jsxs)(m.Z,{sx:{flex:1},children:[(0,r.jsxs)(c.ZP,{container:!0,justifyContent:"space-between",alignItems:"center",sx:{mb:3},children:[(0,r.jsx)(l.Z,{variant:"h6",component:"h3",sx:{mb:1,fontWeight:"medium",fontSize:"2rem"},style:{},color:"#01579B",children:e.name}),(0,r.jsxs)(m.Z,{children:[(0,r.jsx)(d.Z,{startIcon:(0,r.jsx)(S.Z,{}),sx:{px:1,py:.5,borderRadius:1,mr:1,mb:1,fontSize:"1rem"}}),(0,r.jsx)(d.Z,{sx:{px:1,py:.5,borderRadius:1,mr:1,mb:1,fontSize:"1rem"},onClick:()=>handleOpenModal(e.id),children:"Add Movie"})]})]}),(0,r.jsxs)(m.Z,{sx:{px:1,py:.5,borderRadius:1,mr:1,mb:1,fontSize:"1rem"},children:["Current Movie: ",e.currentMovie]}),(0,r.jsxs)(m.Z,{sx:{px:1,py:.5,borderRadius:1,mr:1,mb:1,fontSize:"1rem"},children:["Run time: ",e.runtime]}),(0,r.jsxs)(m.Z,{sx:{px:1,py:.5,borderRadius:1,mr:1,mb:1,fontSize:"1rem"},children:["cost: ",e.cost,"$"]}),(0,r.jsxs)(m.Z,{sx:{bgcolor:"blue.100",color:"blue.800",px:1,py:.5,borderRadius:1,mr:1,mb:1,fontSize:"1rem"},children:["Maximum Capacity: ",e.maxCapacity]}),(0,r.jsxs)(m.Z,{sx:{display:"flex",flexWrap:"wrap",alignItems:"center",mb:2},children:[(0,r.jsx)(m.Z,{sx:{bgcolor:"blue.100",color:"blue.800",px:1,py:.5,borderRadius:1,mr:1,mb:1,fontSize:"1rem"},children:"Timings:"}),e.timings.map((e,t)=>(0,r.jsx)(d.Z,{sx:{px:1,py:.5,borderRadius:1,mr:1,mb:1,fontSize:"1rem"},children:e},t))]}),(0,r.jsx)(d.Z,{onClick:()=>{!function(e){let n=[{theaterId:t},{screenId:e.id}],r=G(n);console.log(r)}(e)},variant:"contained",children:"Book Ticket"})]})]})},n))})})]})}),(0,r.jsx)(x.Z,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:T,onClose:()=>I(!1),closeAfterTransition:!0,slots:{backdrop:u.Z},slotProps:{backdrop:{timeout:500}},children:(0,r.jsx)(h.Z,{in:T,children:(0,r.jsx)(m.Z,{sx:{...C,display:"flex",justifyContent:"center",alignItems:"center",width:"600px",maxWidth:"1000px"},children:(0,r.jsx)(p.Z,{direction:"column",spacing:2,sx:{width:"100%",maxWidth:"900px"},children:(0,r.jsxs)("form",{action:"/screen/addMovie",onSubmit:A(onSubmit),children:[(0,r.jsxs)(c.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(c.ZP,{item:!0,xs:12,md:12,lg:6,children:(0,r.jsx)(_.Qr,{name:"movie",control:F,defaultValue:"",render:e=>{let{field:t}=e;return(0,r.jsxs)(f.Z,{fullWidth:!0,margin:"normal",error:!!N.format,children:[(0,r.jsx)(g.Z,{children:"Add Movie"}),(0,r.jsx)(b.Z,{...t,label:"Add Movie",children:z.map(e=>(0,r.jsx)(j.Z,{value:e.id,children:e.name},e.id))}),(0,r.jsx)(Z.Z,{id:"component-error-text",children:getErrorMessage(N.format)})]})}})}),(0,r.jsx)(c.ZP,{item:!0,xs:12,md:12,lg:6,children:(0,r.jsx)(_.Qr,{name:"ticketPrice",control:F,defaultValue:"",render:e=>{let{field:t}=e;return(0,r.jsx)(y.Z,{...t,InputProps:{inputProps:{min:5,max:10}},type:"number",label:"Ticket Price",error:!!N.ticketPrice,helperText:getErrorMessage(N.ticketPrice),fullWidth:!0,margin:"normal"})}})})]}),(0,r.jsx)(d.Z,{variant:"contained",endIcon:(0,r.jsx)(w.Z,{}),type:"submit",children:"Add Movie"})]})})})})})]})}},36661:function(e,t,n){"use strict";async function handleResponse(e){let t=e.headers.get("Content-Type")||"",n=t.includes("application/json"),r=n?await e.json():await e.text();if(!e.ok){if(n&&null!==r.errors)throw Error(JSON.stringify(r.errors));throw Error(r.message||e.statusText)}return r}async function getDataFromEndPoint(e,t,n){let r="api//"+t,i=e instanceof FormData;if("GET"==n){let e=await fetch(r,{method:n,credentials:"include"});return handleResponse(e).then(e=>e)}let s={method:n,credentials:"include",body:e};console.log(e),i||(s.headers={"Content-Type":"application/json"},s.body=JSON.stringify(e)),console.log(s.body);let a=await fetch(r,s);return handleResponse(a).then(e=>e)}n.d(t,{e:function(){return getDataFromEndPoint}})}},function(e){e.O(0,[5094,3807,3226,5295,4141,8874,414,5445,7494,2971,2472,1744],function(){return e(e.s=11865)}),_N_E=e.O()}]);